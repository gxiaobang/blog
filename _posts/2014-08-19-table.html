---
layout: default
title: 倔强的表格固定
---

<p>
	想到固定就想到css属性(position: fixed)，相对于window固定，而现在需求相对于包裹表格的element固定，显然fixed并不适用。单纯的css解决不了，只能用绝对定位外加js控制，根据滚动条的距离来设置固定位置。
</p>

<link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/assets/css/table.css">
<div class="table-wrap">
	<div class="table-scroll">
		<table class="table-self">
			<thead>
				<tr>
					<td>序号</td>
					<td>姓名</td>
					<td>编号</td>
					<td>职位</td>
					<td>部门</td>
					<td>备注</td>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>01</td>
					<td>A</td>
					<td>0001</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>02</td>
					<td>B</td>
					<td>0002</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>03</td>
					<td>C</td>
					<td>0003</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>04</td>
					<td>D</td>
					<td>0004</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>05</td>
					<td>E</td>
					<td>0005</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>06</td>
					<td>F</td>
					<td>0006</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>07</td>
					<td>G</td>
					<td>0007</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr><tr>
					<td>08</td>
					<td>H</td>
					<td>0008</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>09</td>
					<td>I</td>
					<td>0009</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>10</td>
					<td>J</td>
					<td>0010</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>11</td>
					<td>K</td>
					<td>0011</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
				<tr>
					<td>12</td>
					<td>L</td>
					<td>0012</td>
					<td>工程师</td>
					<td>生产部</td>
					<td>勤劳、勇敢</td>
				</tr>
			</tbody>		
		</table>
	</div>
	<div class="table-fixed">
		<div class="table-fixed-thead">
			<span>序号</span>
			<span>姓名</span>
			<span>编号</span>
			<span>职位</span>
			<span>部门</span>
			<span>备注</span>
		</div>
	</div>
</div>
<script type="text/javascript">
// 选择器
function $selector( node, context ) {
	return ( context || document ).querySelectorAll( node );
}
function init() {
	var tableWrap = $selector( '.table-wrap' )[0],
		tableScroll = $selector( '.table-scroll', tableWrap )[0],
		tableSelf = $selector( '.table-self', tableWrap )[0],
		tableFixed = $selector( '.table-fixed', tableWrap )[0],
		tableFixedSpans = $selector( 'span', tableFixed ),
		i = 0;

	function makeFixedBox() {
		// 设置fixed宽度
		tableFixed.style.width = tableScroll.clientWidth + 'px';
		tableFixed.children[0].style.width = tableScroll.scrollWidth + 10 + 'px';

		var cells = tableSelf.tHead.rows[0].cells;
		for( var i = 0; i < tableFixedSpans.length; i++ ) {
			tableFixedSpans[i].style.width = cells[i].offsetWidth - 41 + 'px';
		}
	}
	function scrollFixed() {
		tableFixed.children[0].style.marginLeft = -this.scrollLeft + 'px';
	}

	makeFixedBox();
	tableScroll.onscroll = scrollFixed;
}

window.onload = init;
</script>